# Retrospective - Epics 2 & 3: Intelligent Rest & Wake Lock Integration

**Date:** 2025-12-28
**Participants:** Roy (Project Lead), Bob (Scrum Master), John (Product Manager), Amelia (Developer), Murat (QA), Winston (Architect)

## Epic Summary

This joint retrospective covers **Epic 2: Intelligent Block Rest** and **Epic 3: Always-On Visibility (Wake Lock)**. The team successfully implemented a robust resting mechanism between workout blocks and integrated the Screen Wake Lock API to ensure the app remains visible throughout exercise.

**Delivery Metrics:**
- **Completed:** 5/5 stories (100%)
- **Quality:** 71 tests in total. Zero logic regressions detected.
- **Velocity:** High. Parallel execution of UI (2.2) and Preview (2.3) proved effective.

## Key Insights & Learnings

1.  **"Golden Master" Snapshotting is Essential:** Modifying the `linearizer` (the app's core engine) was high-risk. Creating byte-for-byte snapshots *before* implementation allowed us to refactor with absolute confidence.
    - **Action:** Retain Golden Master tests for all future core logic changes.
2.  **Singleton Service Pattern Matures:** We now have a consistent pattern for hardware integrations (`SpeechService`, `WakeLockService`). This reduced "decision fatigue" for the developers.
3.  **Unified Hardware Initialization:** We learned that hardware APIs requiring user gestures (Audio, Speech, Wake Lock) are best handled by a single entry-point handler in the `WorkoutPlayer`.

## Action Items & Commitments

1.  **Expand E2E Coverage (Epic 4 prerequisite):**
    - **Context:** We rely heavily on mocks for hardware APIs in Vitest.
    - **Action:** Implement real-browser E2E tests for Audio, Speech, and Wake Lock.
    - **Owner:** Test Architect / Developer.
2.  **PWA Transformation:**
    - **Context:** The app is intended for offline gym use but lacks PWA infrastructure.
    - **Action:** Implement `vite-plugin-pwa` and offline caching.
    - **Owner:** Architect (Design) / Developer (Implementation).
3.  **Installation UI:**
    - **Context:** Users (especially on iOS) need guidance to "install" the PWA.
    - **Action:** Design and implement installation prompts/guides.
    - **Owner:** UX Designer / Developer.

## Epic 4 Readiness

The team is cleared to proceed with **Epic 4: Production Readiness & PWA Excellence**.
- **First Step:** Architect to define PWA strategy and E2E test infrastructure improvements.
